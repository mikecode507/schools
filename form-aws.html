<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fotos de recuerdo Kinder PTY 2025</title>
    <link rel="stylesheet" href="index.css">
    <link rel="icon" href="data:,">
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>Fotos de recuerdo Kinder PTY 2025</h1>
            <p>Al completar este formulario estás solicitando el paquete de fotos. La contratación es válida después de
                recibir el pago por Yappy o transferencia directo al fotógrafo.</p>
        </div>

        <div class="form-content">
            <form id="photoForm">
                <!-- Campos del formulario -->
                <input type="hidden" id="idEscuela" name="idEscuela" value="clia">

                <div class="form-group">
                    <label for="email">Email<span class="required">*</span></label>
                    <input type="email" id="email" name="email" autocomplete="email" required>
                </div>

                <div class="form-group">
                    <label for="nombre">Sólo tu nombre (sin apellido)<span class="required">*</span></label>
                    <input type="text" id="nombre" name="nombre" required>
                </div>

                <div class="form-group">
                    <label for="celular">Tu número celular para escribirte al WhatsApp.<span
                            class="required">*</span></label>
                    <div style="display: flex; gap: 8px; align-items: flex-start;">
                        <div style="flex: 0 0 auto;">
                           
                            <div class="radio-group" style="margin-top: 0;">
                                <label class="radio-option" style="margin-bottom: 4px;"><input type="radio" name="codigoPais" value="+507" checked required> Panamá</label>
                                <label class="radio-option"><input type="radio" name="codigoPais" value="otro"> Otro país</label>
                            </div>
                        </div>
                        <div style="flex: 1;">
                            <div id="codigoOtroContainer" style="display: none; margin-bottom: 4px;">
                                <input type="text" id="codigoOtro" placeholder="+XXX" style="width: 80px; padding: 8px; border: 1px solid #dadce0; border-radius: 4px; font-size: 14px;">
                            </div>
                            <input type="text" id="celular" name="celular" placeholder="Número celular" required style="width: 100%;">
                            <input type="text" id="celularOtro" name="celularOtro" placeholder="Número completo con código de país" style="width: 100%; display: none; margin-top: 8px;">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Quiero el Paquete<span class="required">*</span></label>
                    <div class="radio-group">
                        <label class="radio-option"><input type="radio" name="paquete" value="paqueteA" required>
                            Paquete A (Impresas + Digital) $36</label>
                        <label class="radio-option"><input type="radio" name="paquete" value="paqueteB"> Paquete B (Sólo
                            Digital) $24</label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="nombreEstudiante">Nombre del estudiante<span class="required">*</span></label>
                    <input type="text" id="nombreEstudiante" name="nombreEstudiante" required>
                </div>

                <div style="margin-top: 32px;">
                    <button type="submit" id="btnEnviar" class="submit-btn">Enviar Formulario</button>
                    <div id="mensajeEstado"></div>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Lógica para mostrar "Otro" en salón
        const salonOtroTexto = document.getElementById('salonOtroTexto');
        document.querySelectorAll('input[name="salon"]').forEach(radio => {
            radio.addEventListener('change', function () {
                salonOtroTexto.style.display = (this.id === 'salonOtro') ? 'block' : 'none';
            });
        });

        // Lógica de envío a AWS
        document.getElementById('photoForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const btn = document.getElementById('btnEnviar');
            const msg = document.getElementById('mensajeEstado');

            btn.disabled = true;
            msg.style.display = 'block';
            msg.style.backgroundColor = '#e8f0fe';
            msg.innerText = "Enviando datos de forma segura...";

            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());

            try {
                const response = await fetch('https://0mqpyca3ra.execute-api.us-east-1.amazonaws.com/prod/contacto', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    msg.style.backgroundColor = '#e6ffed';
                    msg.style.color = '#155724';
                    msg.innerText = "¡Listo! Recibimos tus datos. Pronto te contactaremos.";
                    this.reset();
                } else {
                    throw new Error();
                }
            } catch (error) {
                msg.style.backgroundColor = '#ffeef0';
                msg.style.color = '#721c24';
                msg.innerText = "Hubo un error al enviar. Inténtalo de nuevo.";
            } finally {
                btn.disabled = false;
            }
            // Construir número completo con código de país
            const codigoSeleccionado = document.querySelector('input[name="codigoPais"]:checked').value;
            let numeroCompleto = '';

            if (codigoSeleccionado === '+507') {
                numeroCompleto = '+507' + data.celular;
            } else if (codigoSeleccionado === 'otro') {
                numeroCompleto = data.celularOtro;
            }

            
        });
    </script>
</body>

</html>
